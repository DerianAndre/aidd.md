# Plan — Best DX: Zero-Friction Developer Experience

> Clone → Install → Setup → Code. Nothing else.

**Date**: 2026-02-07
**Status**: In Progress
**Scope**: `scripts/mcp-setup.mjs`, `package.json`, CLI commands
**PRs**: 2 (Setup Unification + CLI Polish)

---

## Context

The AIDD framework requires multiple manual steps to set up: build MCP packages, initialize `.aidd/` directory, manually run `aidd integrate <tool>` for each IDE, and configure MCP config files. This creates friction for both contributors and adopters.

**Goal**: Reduce setup to a single command that handles everything — build, init, IDE detection, configuration, verification.

---

## Target Experience

### Contributors (clone the repo)
| Step | Command | What Happens |
|------|---------|-------------|
| 1 | `git clone` + `cd aidd.md` | Get the repo |
| 2 | `pnpm install` | Install all deps |
| 3 | `pnpm setup` | Build, init, detect IDEs, configure, verify |
| 4 | Open IDE | MCPs auto-start via config files |

### Adopters (use in their project)
| Step | Command | What Happens |
|------|---------|-------------|
| 1 | `npx @aidd.md/cli init` | Copy framework, set up .aidd/, integrate IDEs |
| 2 | Open IDE | MCPs auto-start |

Or manual: copy `AGENTS.md` + `content/` into project.

---

## PR 1: Unified Setup

### What `pnpm setup` does (7 steps)

```
[1/7] Check prerequisites (Node 22+, pnpm 10+)
[2/7] Install all workspace dependencies
[3/7] Build MCP packages (shared → mcps)
[4/7] Initialize .aidd/ directory + config
[5/7] Detect & configure IDEs (interactive: detect → show → confirm → write)
[6/7] Run full diagnostics (mcp:doctor)
[7/7] Print summary with next steps
```

### Smart MCP Path Detection

| Context | MCP Command | Detection |
|---------|-------------|-----------|
| Contributor (aidd.md repo) | `node <abs-path>/mcps/mcp-aidd-engine/dist/index.js` | `mcps/.../dist/index.js` exists |
| Adopter (external project) | `npx -y @aidd.md/mcp-engine` | dist file doesn't exist |

### IDE Detection

| IDE | Detection Method | Config Location |
|-----|-----------------|-----------------|
| Claude Code | `~/.claude/` exists | `~/.claude/mcp.json` (global) |
| Cursor | Always available | `.cursor/mcp.json` (project) |
| VS Code | `.vscode/` exists or `code` CLI | `.vscode/mcp.json` (project) |
| Gemini | `AGENTS.md` exists | Auto-detected (no config needed) |

### Files Modified

| File | Changes |
|------|---------|
| `scripts/mcp-setup.mjs` | Expand 4→7 steps |
| `package.json` (root) | Add `"setup"` script |

---

## PR 2: CLI Polish + Turbo

### Changes

| File | Changes |
|------|---------|
| `turbo.json` (new) | Build caching + dependency graph |
| `package.json` (root) | Add turborepo devDep |
| `packages/cli/src/commands/init.ts` | Auto-integrate IDEs after init |
| `packages/cli/src/commands/status.ts` | Show IDE integration status |

---

## Verification

### PR 1
- [ ] `pnpm setup` runs clean, shows [1/7] through [7/7]
- [ ] IDE detection shows available IDEs
- [ ] Confirmation prompt works (Y/n)
- [ ] Config files written with correct MCP path (local vs npx)
- [ ] Existing MCP servers in config preserved (merge, not overwrite)
- [ ] `.aidd/` directory initialized
- [ ] `mcp:doctor` runs and passes
- [ ] `pnpm mcp:setup` still works (backward compat)

### PR 2
- [ ] `turbo.json` enables build caching
- [ ] Second `pnpm mcp:build` faster (cache hit)
- [ ] `aidd init` auto-integrates IDEs
- [ ] `aidd status` shows integration info
